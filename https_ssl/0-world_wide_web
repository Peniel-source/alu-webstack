#!/usr/bin/env bash
# Description: Audits A records for specified subdomains using dig and awk.
# Usage: ./0-world_wide_web <domain> [subdomain]

audit_subdomain() {
    local subdomain="$1"
    local domain="$2"
    local fqdn="${subdomain}.${domain}"

    dig "$fqdn" | grep "IN" | grep -v ';;' | awk -v sub_name="$subdomain" 'NF >= 5 && $3 == "IN" {printf "The subdomain %s is a %s record and points to %s\n", sub_name, $4, $5}'
}

# Verify if the domain argument is provided
if [ -z "$1" ]; then
    echo "Usage: $0 <domain> [subdomain]"
    exit 1
fi

DOMAIN="$1"
SUBDOMAIN="$2"

if [ -z "$SUBDOMAIN" ]; then
    echo "Auditing default subdomains for: $DOMAIN"

    # Using the required subdomains from the original prompt
    SUBDOMAINS=("www" "lb-01" "web-01" "web-02")

    for SUB in "${SUBDOMAINS[@]}"; do
        audit_subdomain "$SUB" "$DOMAIN"
	sleep 0.3
    done
else
    echo "Auditing specific subdomain: $SUBDOMAIN.$DOMAIN"
        
    audit_subdomain "$SUBDOMAIN" "$DOMAIN"
fi
